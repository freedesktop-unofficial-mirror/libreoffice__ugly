Code included in this module is especially ugly and/or problematic.
Please don't hack in here without seeking advice first.
